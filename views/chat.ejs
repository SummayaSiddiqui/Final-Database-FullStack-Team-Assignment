<%- include('partials/header') %> <% if (!isAuthenticated) { %>
<div class="chat-page">
    <div class="image-section">
      <img
        src="/images/chatBubbleGreen.png"
        alt="green chat bubble"
        class="chat-bubble"
      >
      <img
        src="/images/homePic.jpg"
        alt="People using laptops"
        class="welcome-image"
      />
    </div>
     <div class="text-chat-section">
      <h1>Join Live Chat</h1>
      <p>
        Experience seamless real-time communication with our Live Chat
        feature. Connect, collaborate, and communicate effortlessly with
        others. Log in or sign up now to start your journey!
      </p>
      <div class="cta-buttons">
        <a href="/signup" class="cta-button-1">Sign Up</a>
        <a href="/login" class="cta-button-2">Log In</a>
      </div>
    </div>
    
  
</div>

    <% } else { %>
    <div class="chat-container">
      <div id="user-list" class="online-users">
        <!-- Online users will be dynamically populated here -->
      </div>

      <div class="header">
        <h2>Welcome, <%= username %>!</h2>
        <div id="user-list"></div>
      </div>
<% if (messagesBeforeLogin && messagesBeforeLogin.length > 0) { %>
  <div class="messages-before-login">
    <% messagesBeforeLogin.forEach(function(message) { %>
      <div class="message">
        <strong><%= message.sender %></strong>
        <span class="timestamp"><%= new Date(message.timestamp).toLocaleTimeString() %></span>
        <p><%= message.content %></p>
      </div>
    <% }); %>
  </div>
<% } else { %>
  <p>No messages before login.</p>
<% } %>

<!-- After Login Messages -->
<p class="downward-message">
  <span class="arrow">&#8595;</span><span class="arrow">&#8595;</span> Messages After Login <span class="arrow">&#8595;</span><span class="arrow">&#8595;</span>
</p>

<% if (messagesAfterLogin && messagesAfterLogin.length > 0) { %>
  <div class="messages-after-login">
    <% messagesAfterLogin.forEach(function(message) { %>
      <div class="message">
        <strong><%= message.sender %></strong>
        <span class="timestamp"><%= new Date(message.timestamp).toLocaleTimeString() %></span>
        <p><%= message.content %></p>
      </div>
    <% }); %>
  </div>
<% } else { %>
  <p>No messages after login.</p>
<% } %>
      <div class="messages" id="messages"></div>

      <!-- Form at the bottom -->
      <form id="chat-form">
        <input
          type="text"
          id="message-input"
          placeholder="Type a message..."
          autocomplete="off" />
        <button type="submit">Send</button>
      </form>
    </div>
    <script>
      const currentUsername = "<%= username %>";
    </script>
    <script src="frontend.js" type ="text/javascript"></script>
    <% } %> <%- include('partials/footer') %>
</div>